<%- layout('layout/boilerplate') -%>
<script src="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js"></script>
<link
  href="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css"
  rel="stylesheet"
/>
<div class="container-fluid">
  <div
    id="map"
    style="width: 100%; height: 350px"
    class="side-border-radius mb-2"
  ></div>
</div>

<div class="container">
  <div class="row">
    <div class="col-6 offset-3 p-4">
      <form class="d-flex">
        <input
          class="form-control me-2"
          type="search"
          placeholder="Search"
          aria-label="Search"
        />
        <!-- <button class="btn btn-dark" type="submit">Search</button> -->
      </form>
    </div>
  </div>
  <div class="row px-5">
    <% for (let place of places) {%>
    <div class="col p-4">
      <div
        class="card bg-secondary border-0 side-border-radius card-box"
        style="max-width: 26rem; min-width: 22rem"
      >
        <div class="card-body">
          <% if (place.images[0]) {%>
          <div
            class="card-body side-image side-border-radius"
            style="
              background-image: url(<%= place.images[0].thumbnail %>);
              min-height: 22rem;
            "
          ></div>
          <% } else {%>
          <div class="card-body side-border-radius" style="min-height: 22rem">
            <p>No Images</p>
          </div>
          <% } %>
          <h5 class="card-title text-center py-3 h4"><%= place.title %></h5>
          <div class="d-flex justify-content-between">
            <p><%= place.location %></p>
            <a href="/places/<%=place.id%>" class="btn btn-dark px-5"
              >View place</a
            >
          </div>
        </div>
      </div>
    </div>
    <% } %>
  </div>
</div>

<script>
  const mbToken = '<%- process.env.MAPBOX_TOKEN %>'
  const places = {features: <%- JSON.stringify(places) %>}
</script>
<script src="/javascripts/mapCluster.js"></script>
