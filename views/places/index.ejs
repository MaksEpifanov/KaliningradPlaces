<%- layout('layout/boilerplate') -%>
<script src="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.js"></script>
<link
  href="https://api.mapbox.com/mapbox-gl-js/v2.5.1/mapbox-gl.css"
  rel="stylesheet"
/>
<div>
  <div id="map" style="width: 100%; height: 500px"></div>
</div>
<div class="container">
  <div class="row">
    <% for (let place of places) {%>
    <div class="col-4">
      <div class="card">
        <div class="card-body">
          <% if (place.images[0]) {%>
          <img src="<%= place.images[0].url %>" alt="" />
          <% } else {%>
          <p>No image</p>
          <% } %>
          <h5 class="card-title"><%= place.title %></h5>
          <p><%= place.location %></p>
          <a href="/places/<%=place.id%>" class="btn btn-primary"
            >Go somewhere</a
          >
        </div>
      </div>
    </div>
    <% } %>
  </div>
</div>

<script>
  const mbToken = '<%- process.env.MAPBOX_TOKEN %>'
  const places = {features: <%- JSON.stringify(places) %>}
</script>
<script src="/javascripts/mapCluster.js"></script>
